<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel Admina - Serwery</title>
<style>
:root {
    --bg-primary: #0a0a0a;
    --bg-secondary: #1a1a1a;
    --bg-tertiary: #252525;
    --text-primary: #ffffff;
    --text-secondary: #aaaaaa;
    --text-tertiary: #666666;
    --accent-red: #8b0000;
    --accent-red-hover: #660000;
    --accent-green: #008b00;
    --border-color: #333333;
    --border-hover: #444444;
    --shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
}

body {
    background: var(--bg-primary);
    color: var(--text-primary);
    min-height: 100vh;
}

.container {
    display: grid;
    grid-template-columns: 250px 1fr;
    min-height: 100vh;
}

.sidebar {
    background: var(--bg-secondary);
    border-right: 1px solid var(--border-color);
    padding: 20px;
    position: sticky;
    top: 0;
    height: 100vh;
    overflow-y: auto;
}

.sidebar-header {
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
    margin-bottom: 20px;
}

.sidebar-header h2 {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 5px;
    background: linear-gradient(90deg, #ffffff, var(--accent-red));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.sidebar-header p {
    color: var(--text-secondary);
    font-size: 12px;
}

.nav-item {
    display: flex;
    align-items: center;
    padding: 12px 15px;
    color: var(--text-secondary);
    text-decoration: none;
    border-radius: 10px;
    margin-bottom: 8px;
    transition: all 0.3s ease;
    cursor: pointer;
}

.nav-item i {
    margin-right: 12px;
    width: 20px;
    text-align: center;
}

.nav-item.active {
    background: var(--accent-red);
    color: white;
}

.nav-item:hover:not(.active) {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.main-content {
    padding: 30px;
    overflow-y: auto;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
}

.header h1 {
    font-size: 28px;
    font-weight: 600;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logout-btn {
    padding: 8px 20px;
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
}

.logout-btn:hover {
    background: var(--accent-red);
    color: white;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: var(--bg-secondary);
    border-radius: 15px;
    padding: 20px;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
}

.stat-card:hover {
    border-color: var(--border-hover);
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

.stat-value {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 5px;
}

.stat-label {
    color: var(--text-secondary);
    font-size: 14px;
    font-weight: 500;
}

.servers-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 25px;
}

.server-card {
    background: var(--bg-secondary);
    border-radius: 15px;
    padding: 25px;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
}

.server-card:hover {
    border-color: var(--border-hover);
    transform: translateY(-3px);
    box-shadow: var(--shadow);
}

.server-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
}

.server-title {
    font-size: 18px;
    font-weight: 600;
}

.server-id {
    font-family: 'Consolas', monospace;
    color: var(--text-secondary);
    font-size: 12px;
    background: var(--bg-tertiary);
    padding: 4px 8px;
    border-radius: 6px;
}

.players-list {
    flex-grow: 1;
    margin-bottom: 20px;
}

.player-item {
    display: flex;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--border-color);
}

.player-item:last-child {
    border-bottom: none;
}

.player-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin-right: 12px;
    object-fit: cover;
    border: 2px solid var(--border-color);
}

.player-info {
    flex-grow: 1;
}

.player-name {
    font-weight: 500;
    color: var(--text-primary);
    text-decoration: none;
    transition: color 0.3s ease;
}

.player-name:hover {
    color: var(--accent-red);
}

.player-id {
    font-size: 11px;
    color: var(--text-tertiary);
    font-family: 'Consolas', monospace;
}

.playtime {
    color: var(--text-secondary);
    font-size: 13px;
    font-weight: 500;
    white-space: nowrap;
}

.server-actions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: auto;
}

.action-btn {
    padding: 10px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    font-size: 13px;
    transition: all 0.3s ease;
}

.kick-btn {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.kick-btn:hover {
    background: #8b4500;
}

.ban-btn {
    background: var(--accent-red);
    color: white;
}

.ban-btn:hover {
    background: var(--accent-red-hover);
}

.unban-btn {
    background: var(--accent-green);
    color: white;
}

.unban-btn:hover {
    background: #006600;
}

.shutdown-btn {
    grid-column: 1 / -1;
    background: linear-gradient(45deg, var(--accent-red), #660000);
    color: white;
    padding: 12px;
}

.shutdown-btn:hover {
    background: linear-gradient(45deg, #660000, #440000);
}

.tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 25px;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
}

.tab {
    padding: 10px 20px;
    background: transparent;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    font-weight: 500;
    border-radius: 8px 8px 0 0;
    transition: all 0.3s ease;
    position: relative;
}

.tab.active {
    color: var(--text-primary);
    background: var(--bg-tertiary);
}

.tab.active::after {
    content: '';
    position: absolute;
    bottom: -16px;
    left: 0;
    width: 100%;
    height: 3px;
    background: var(--accent-red);
    border-radius: 2px;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
}

.modal-content {
    background: var(--bg-secondary);
    border-radius: 20px;
    padding: 30px;
    width: 90%;
    max-width: 500px;
    border: 1px solid var(--border-color);
    animation: modalSlide 0.3s ease;
}

@keyframes modalSlide {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.modal-title {
    font-size: 20px;
    font-weight: 600;
}

.modal-close {
    background: none;
    border: none;
    color: var(--text-secondary);
    font-size: 24px;
    cursor: pointer;
    padding: 5px;
    line-height: 1;
}

.modal-close:hover {
    color: var(--text-primary);
}

.modal-input {
    width: 100%;
    padding: 14px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    color: var(--text-primary);
    font-size: 15px;
    margin-bottom: 20px;
}

.modal-input:focus {
    outline: none;
    border-color: var(--accent-red);
}

.modal-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}

.modal-btn {
    padding: 12px 24px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
}

.modal-btn.cancel {
    background: var(--bg-tertiary);
    color: var(--text-secondary);
}

.modal-btn.cancel:hover {
    background: #333333;
    color: var(--text-primary);
}

.modal-btn.confirm {
    background: var(--accent-red);
    color: white;
}

.modal-btn.confirm:hover {
    background: var(--accent-red-hover);
}

.toast {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--accent-green);
    color: white;
    padding: 15px 25px;
    border-radius: 10px;
    box-shadow: var(--shadow);
    display: none;
    z-index: 1001;
    animation: toastSlide 0.3s ease;
}

@keyframes toastSlide {
    from {
        opacity: 0;
        transform: translateX(100px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@media (max-width: 1024px) {
    .container {
        grid-template-columns: 1fr;
    }
    
    .sidebar {
        display: none;
    }
    
    .servers-grid {
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    }
}

@media (max-width: 768px) {
    .main-content {
        padding: 20px;
    }
    
    .header {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .servers-grid {
        grid-template-columns: 1fr;
    }
    
    .server-actions {
        grid-template-columns: 1fr;
    }
}
</style>
</head>
<body>
<div class="container">
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>Panel Admina</h2>
            <p>System zarzƒÖdzania serwerami</p>
        </div>
        <div class="nav-item active" onclick="showTab('servers')">
            <i>‚öôÔ∏è</i> Serwery
        </div>
        <div class="nav-item" onclick="showTab('players')">
            <i>üë•</i> Gracze
        </div>
        <div class="nav-item" onclick="showTab('bans')">
            <i>üö´</i> Bany
        </div>
        <div class="nav-item" onclick="showTab('logs')">
            <i>üìã</i> Logi
        </div>
    </div>
    
    <div class="main-content">
        <div class="header">
            <h1>ZarzƒÖdzanie serwerami</h1>
            <div class="user-info">
                <span>Witaj, <strong>admin</strong></span>
                <button class="logout-btn" onclick="logout()">Wyloguj</button>
            </div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalServers">0</div>
                <div class="stat-label">Aktywnych serwer√≥w</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalPlayers">0</div>
                <div class="stat-label">≈ÅƒÖcznie graczy</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalBans">0</div>
                <div class="stat-label">Aktywnych ban√≥w</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="uptime">100%</div>
                <div class="stat-label">Dostƒôpno≈õƒá API</div>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('servers')">Serwery</button>
            <button class="tab" onclick="showTab('players')">Gracze</button>
            <button class="tab" onclick="showTab('bans')">Bany</button>
            <button class="tab" onclick="showTab('logs')">Logi systemowe</button>
        </div>
        
        <div id="serversTab" class="tab-content">
            <div class="servers-grid" id="serversContainer">
                <!-- Serwery bƒôdƒÖ ≈Çadowane dynamicznie -->
            </div>
        </div>
        
        <div id="playersTab" class="tab-content" style="display: none;">
            <div class="players-table" id="playersContainer">
                <!-- Lista wszystkich graczy -->
            </div>
        </div>
        
        <div id="bansTab" class="tab-content" style="display: none;">
            <div class="bans-list" id="bansContainer">
                <!-- Lista ban√≥w -->
            </div>
        </div>
        
        <div id="logsTab" class="tab-content" style="display: none;">
            <div class="logs-container" id="logsContainer">
                <!-- Logi systemowe -->
            </div>
        </div>
    </div>
</div>

<div id="kickModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Wykop gracza</h3>
            <button class="modal-close" onclick="closeModal('kickModal')">&times;</button>
        </div>
        <input type="text" id="kickPlayerId" class="modal-input" placeholder="ID gracza lub nazwa" readonly>
        <input type="text" id="kickReason" class="modal-input" placeholder="Pow√≥d wykopania">
        <div class="modal-actions">
            <button class="modal-btn cancel" onclick="closeModal('kickModal')">Anuluj</button>
            <button class="modal-btn confirm" onclick="confirmKick()">Wykop</button>
        </div>
    </div>
</div>

<div id="banModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Zbanuj gracza</h3>
            <button class="modal-close" onclick="closeModal('banModal')">&times;</button>
        </div>
        <input type="text" id="banPlayerId" class="modal-input" placeholder="ID gracza lub nazwa" readonly>
        <input type="text" id="banReason" class="modal-input" placeholder="Pow√≥d bana">
        <input type="number" id="banDuration" class="modal-input" placeholder="Czas trwania (w godzinach, 0 = permanentnie)" min="0" step="1">
        <div class="modal-actions">
            <button class="modal-btn cancel" onclick="closeModal('banModal')">Anuluj</button>
            <button class="modal-btn confirm" onclick="confirmBan()">Zbanuj</button>
        </div>
    </div>
</div>

<div id="shutdownModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Wy≈ÇƒÖcz serwer</h3>
            <button class="modal-close" onclick="closeModal('shutdownModal')">&times;</button>
        </div>
        <input type="text" id="shutdownServerId" class="modal-input" placeholder="ID serwera" readonly>
        <input type="text" id="shutdownReason" class="modal-input" placeholder="Pow√≥d wy≈ÇƒÖczenia">
        <div class="modal-actions">
            <button class="modal-btn cancel" onclick="closeModal('shutdownModal')">Anuluj</button>
            <button class="modal-btn confirm" onclick="confirmShutdown()">Wy≈ÇƒÖcz</button>
        </div>
    </div>
</div>

<div id="toast" class="toast"></div>

<script>
const API_KEY = "SECRET_KEY_123";
const BACKEND_URL = "https://backrobloxserver.fly.dev";

let currentKickPlayer = {};
let currentBanPlayer = {};
let currentServerId = "";

function showTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.style.display = 'none';
    });
    
    document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
    });
    
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    
    document.getElementById(tabName + 'Tab').style.display = 'block';
    event.target.classList.add('active');
    
    document.querySelectorAll('.nav-item').forEach(item => {
        if (item.textContent.includes(tabName.charAt(0).toUpperCase() + tabName.slice(1))) {
            item.classList.add('active');
        }
    });
    
    if (tabName === 'players') loadAllPlayers();
    if (tabName === 'bans') loadBans();
    if (tabName === 'logs') loadLogs();
}

function openModal(modalId, data = {}) {
    if (modalId === 'kickModal') {
        document.getElementById('kickPlayerId').value = data.playerName;
        currentKickPlayer = data;
    } else if (modalId === 'banModal') {
        document.getElementById('banPlayerId').value = data.playerName;
        currentBanPlayer = data;
    } else if (modalId === 'shutdownModal') {
        document.getElementById('shutdownServerId').value = data.serverId;
        currentServerId = data.serverId;
    }
    
    document.getElementById(modalId).style.display = 'flex';
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.style.background = type === 'success' ? '#008b00' : '#8b0000';
    toast.style.display = 'block';
    
    setTimeout(() => {
        toast.style.display = 'none';
    }, 3000);
}

async function loadServers() {
    try {
        const res = await fetch(BACKEND_URL + "/servers");
        const servers = await res.json();
        const container = document.getElementById("serversContainer");
        
        let totalPlayers = 0;
        container.innerHTML = "";
        
        servers.forEach(server => {
            totalPlayers += server.playerCount;
            
            const serverCard = document.createElement("div");
            serverCard.className = "server-card";
            
            serverCard.innerHTML = `
                <div class="server-header">
                    <div class="server-title">${server.playerCount} graczy online</div>
                    <div class="server-id">ID: ${server.instanceId}</div>
                </div>
                
                <div class="players-list">
                    ${server.players.sort((a, b) => b.playtime - a.playtime).map(p => `
                        <div class="player-item">
                            <img src="${p.avatar}" alt="${p.name}" class="player-avatar">
                            <div class="player-info">
                                <a href="https://www.roblox.com/users/${p.userId}/profile" target="_blank" class="player-name">
                                    ${p.name}
                                </a>
                                <div class="player-id">ID: ${p.userId}</div>
                            </div>
                            <div class="playtime">${Math.floor(p.playtime / 60)} min</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="server-actions">
                    <button class="action-btn kick-btn" onclick="openModal('kickModal', {playerId: '', playerName: 'Wybierz gracza z listy'})">
                        Kick
                    </button>
                    <button class="action-btn ban-btn" onclick="openModal('banModal', {playerId: '', playerName: 'Wybierz gracza z listy'})">
                        Ban
                    </button>
                    <button class="action-btn unban-btn" onclick="showToast('Funkcja odbanowywania wkr√≥tce', 'info')">
                        Unban
                    </button>
                    <button class="action-btn shutdown-btn" onclick="openModal('shutdownModal', {serverId: '${server.instanceId}'})">
                        üî¥ Wy≈ÇƒÖcz serwer
                    </button>
                </div>
            `;
            
            container.appendChild(serverCard);
        });
        
        document.getElementById('totalServers').textContent = servers.length;
        document.getElementById('totalPlayers').textContent = totalPlayers;
        
    } catch (error) {
        console.error("B≈ÇƒÖd ≈Çadowania serwer√≥w:", error);
    }
}

async function loadAllPlayers() {
    try {
        const res = await fetch(BACKEND_URL + "/servers");
        const servers = await res.json();
        const container = document.getElementById("playersContainer");
        
        let allPlayers = [];
        servers.forEach(server => {
            allPlayers = allPlayers.concat(server.players);
        });
        
        const uniquePlayers = Array.from(new Map(allPlayers.map(p => [p.userId, p])).values());
        
        container.innerHTML = `
            <div class="server-card">
                <div class="server-header">
                    <div class="server-title">≈ÅƒÖcznie: ${uniquePlayers.length} unikalnych graczy</div>
                </div>
                <div class="players-list">
                    ${uniquePlayers.sort((a, b) => b.playtime - a.playtime).slice(0, 20).map(p => `
                        <div class="player-item">
                            <img src="${p.avatar}" alt="${p.name}" class="player-avatar">
                            <div class="player-info">
                                <a href="https://www.roblox.com/users/${p.userId}/profile" target="_blank" class="player-name">
                                    ${p.name}
                                </a>
                                <div class="player-id">ID: ${p.userId}</div>
                            </div>
                            <div class="playtime">${Math.floor(p.playtime / 60)} min</div>
                            <button class="action-btn kick-btn" onclick="openModal('kickModal', {playerId: ${p.userId}, playerName: '${p.name}'})">
                                Kick
                            </button>
                            <button class="action-btn ban-btn" onclick="openModal('banModal', {playerId: ${p.userId}, playerName: '${p.name}'})">
                                Ban
                            </button>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
        
    } catch (error) {
        console.error("B≈ÇƒÖd ≈Çadowania graczy:", error);
    }
}

async function loadBans() {
    const container = document.getElementById("bansContainer");
    
    try {
        const res = await fetch(BACKEND_URL + "/bans");
        const bans = await res.json();
        
        document.getElementById('totalBans').textContent = bans.length;
        
        container.innerHTML = `
            <div class="server-card">
                <div class="server-header">
                    <div class="server-title">Aktywne bany: ${bans.length}</div>
                </div>
                <div class="players-list">
                    ${bans.map(ban => `
                        <div class="player-item">
                            <div class="player-info">
                                <div class="player-name">${ban.playerName}</div>
                                <div class="player-id">ID: ${ban.playerId} | Pow√≥d: ${ban.reason}</div>
                                <div class="player-id">Wygasa: ${ban.expiresAt || 'Nigdy'}</div>
                            </div>
                            <button class="action-btn unban-btn" onclick="unbanPlayer(${ban.playerId})">
                                Unban
                            </button>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    } catch (error) {
        container.innerHTML = '<div class="server-card">Brak danych o banach</div>';
    }
}

async function loadLogs() {
    const container = document.getElementById("logsContainer");
    
    try {
        const res = await fetch(BACKEND_URL + "/logs");
        const logs = await res.json();
        
        container.innerHTML = `
            <div class="server-card">
                <div class="server-header">
                    <div class="server-title">Logi systemowe</div>
                </div>
                <div style="font-family: 'Consolas', monospace; font-size: 13px; max-height: 500px; overflow-y: auto;">
                    ${logs.map(log => `
                        <div style="padding: 8px 0; border-bottom: 1px solid #333;">
                            <span style="color: #666;">[${new Date(log.timestamp).toLocaleString()}]</span>
                            <span style="color: ${log.type === 'error' ? '#ff4444' : log.type === 'warning' ? '#ffaa00' : '#44ff44'}">
                                ${log.message}
                            </span>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    } catch (error) {
        container.innerHTML = '<div class="server-card">Brak log√≥w</div>';
    }
}

async function confirmKick() {
    const reason = document.getElementById('kickReason').value;
    if (!reason) {
        showToast('Podaj pow√≥d wykopania', 'error');
        return;
    }
    
    try {
        const response = await fetch(BACKEND_URL + "/kick", {
            method: "POST",
            headers: { 
                "Content-Type": "application/json",
                "Authorization": API_KEY
            },
            body: JSON.stringify({
                playerId: currentKickPlayer.playerId,
                playerName: currentKickPlayer.playerName,
                reason: reason
            })
        });
        
        if (response.ok) {
            showToast(`Gracz ${currentKickPlayer.playerName} zosta≈Ç wykopany`);
            closeModal('kickModal');
            document.getElementById('kickReason').value = '';
        } else {
            showToast('B≈ÇƒÖd podczas wykopania gracza', 'error');
        }
    } catch (error) {
        showToast('B≈ÇƒÖd po≈ÇƒÖczenia z API', 'error');
    }
}

async function confirmBan() {
    const reason = document.getElementById('banReason').value;
    const duration = document.getElementById('banDuration').value;
    
    if (!reason) {
        showToast('Podaj pow√≥d bana', 'error');
        return;
    }
    
    try {
        const response = await fetch(BACKEND_URL + "/ban", {
            method: "POST",
            headers: { 
                "Content-Type": "application/json",
                "Authorization": API_KEY
            },
            body: JSON.stringify({
                playerId: currentBanPlayer.playerId,
                playerName: currentBanPlayer.playerName,
                reason: reason,
                duration: duration ? parseInt(duration) : 0
            })
        });
        
        if (response.ok) {
            showToast(`Gracz ${currentBanPlayer.playerName} zosta≈Ç zbanowany`);
            closeModal('banModal');
            document.getElementById('banReason').value = '';
            document.getElementById('banDuration').value = '';
            loadBans();
        } else {
            showToast('B≈ÇƒÖd podczas banowania gracza', 'error');
        }
    } catch (error) {
        showToast('B≈ÇƒÖd po≈ÇƒÖczenia z API', 'error');
    }
}

async function confirmShutdown() {
    const reason = document.getElementById('shutdownReason').value;
    if (!reason) {
        showToast('Podaj pow√≥d wy≈ÇƒÖczenia', 'error');
        return;
    }
    
    try {
        const response = await fetch(BACKEND_URL + "/shutdown", {
            method: "POST",
            headers: { 
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                serverId: currentServerId,
                reason: reason,
                apiKey: API_KEY
            })
        });
        
        if (response.ok) {
            showToast(`Serwer ${currentServerId} zostanie wy≈ÇƒÖczony`);
            closeModal('shutdownModal');
            document.getElementById('shutdownReason').value = '';
        } else {
            showToast('B≈ÇƒÖd podczas wy≈ÇƒÖczania serwera', 'error');
        }
    } catch (error) {
        showToast('Funkcja wy≈ÇƒÖczania serwera jest obecnie niedostƒôpna', 'error');
    }
}

async function unbanPlayer(playerId) {
    try {
        const response = await fetch(BACKEND_URL + "/unban", {
            method: "POST",
            headers: { 
                "Content-Type": "application/json",
                "Authorization": API_KEY
            },
            body: JSON.stringify({
                playerId: playerId
            })
        });
        
        if (response.ok) {
            showToast('Gracz zosta≈Ç odbanowany');
            loadBans();
        }
    } catch (error) {
        showToast('B≈ÇƒÖd podczas odbanowywania', 'error');
    }
}

function logout() {
    localStorage.removeItem('admin_authenticated');
    window.location.href = '/';
}

if (!localStorage.getItem('admin_authenticated')) {
    window.location.href = '/';
}

setInterval(() => {
    document.getElementById('uptime').textContent = '‚úì';
    setTimeout(() => {
        document.getElementById('uptime').textContent = '100%';
    }, 500);
}, 5000);

loadServers();
setInterval(loadServers, 5000);
</script>
</body>
</html>
